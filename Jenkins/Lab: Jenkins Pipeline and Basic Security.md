# Lab: Jenkins Pipeline and Basic Security

<img width="1767" height="1106" alt="image" src="https://github.com/user-attachments/assets/fe9bf8cb-b687-4f44-937a-afc1b3bec52e" />
<img width="1915" height="886" alt="image" src="https://github.com/user-attachments/assets/8b511adb-ceea-412d-a88b-d6d0a88888b1" />
<img width="1010" height="987" alt="image" src="https://github.com/user-attachments/assets/372c2e6f-1284-4faa-b768-32bd5711e8de" />
<img width="2527" height="1360" alt="image" src="https://github.com/user-attachments/assets/0921b74d-8c1d-40d6-bfc2-afcc410f1905" />
<img width="727" height="271" alt="image" src="https://github.com/user-attachments/assets/b74a7c1c-99db-44da-bd48-2f182cd29228" />
<img width="1070" height="572" alt="image" src="https://github.com/user-attachments/assets/a2d1719a-f656-4e25-af03-d8b5998a552b" />
<img width="2487" height="1391" alt="image" src="https://github.com/user-attachments/assets/3a4f1bf8-2235-4d86-b13a-30562cd97ae9" />
<img width="1027" height="1252" alt="image" src="https://github.com/user-attachments/assets/8190f867-f471-4f8b-8447-e4ea8a46e699" />
<img width="962" height="787" alt="image" src="https://github.com/user-attachments/assets/88c010ce-1c26-4252-a03e-e1d361ac6818" />
<img width="998" height="1305" alt="image" src="https://github.com/user-attachments/assets/ceb27259-2752-46ff-82ec-3a17eca17148" />
<img width="1017" height="1403" alt="image" src="https://github.com/user-attachments/assets/d5e3b322-c666-462b-af39-421ce7b83009" />
<img width="902" height="530" alt="image" src="https://github.com/user-attachments/assets/f7b8483d-4051-488a-b126-7cd7e1ab357f" />
<img width="397" height="213" alt="image" src="https://github.com/user-attachments/assets/f49614fc-b504-4a84-acf7-d2daa9513c2c" />
<img width="752" height="120" alt="image" src="https://github.com/user-attachments/assets/dea209d9-8d92-4ec0-82be-85bfbc9b26db" />
<img width="972" height="1257" alt="image" src="https://github.com/user-attachments/assets/97eb5ee5-aee9-4f22-afd3-b162ccf4500b" />
<img width="987" height="1247" alt="image" src="https://github.com/user-attachments/assets/e5d60d85-2862-4f32-8136-92cb2804335b" />
<img width="957" height="856" alt="image" src="https://github.com/user-attachments/assets/7f5b10e6-56c7-413d-a3ba-f80a0e7fd460" />
<img width="988" height="632" alt="image" src="https://github.com/user-attachments/assets/a4cbbdf5-4a5e-4476-bab1-aeb6a0e86bbc" />
<img width="552" height="200" alt="image" src="https://github.com/user-attachments/assets/83a6c57a-3299-4bba-a8ae-8f2ea8d11d27" />
<img width="1013" height="1248" alt="image" src="https://github.com/user-attachments/assets/bee1a99b-71cd-4d52-938a-6781e47d73ec" />
<img width="1028" height="641" alt="image" src="https://github.com/user-attachments/assets/028e96cf-26ad-4c56-bf36-574d6c911d52" />
<img width="1011" height="1353" alt="image" src="https://github.com/user-attachments/assets/46256c7a-e8f8-4451-9c8c-79b1925c0091" />
<img width="982" height="280" alt="image" src="https://github.com/user-attachments/assets/cec7dfe2-e2d6-4873-bf70-aeae3418a071" />
<img width="1041" height="627" alt="image" src="https://github.com/user-attachments/assets/74ca9112-ae21-4baf-a6bc-f774dee756a9" />
<img width="1253" height="873" alt="image" src="https://github.com/user-attachments/assets/aaf73a7c-3560-4afd-b4f9-2632fd0e2b3f" />
<img width="922" height="685" alt="image" src="https://github.com/user-attachments/assets/9910b98f-f172-4060-b549-f9ff3676df79" />
<img width="467" height="858" alt="image" src="https://github.com/user-attachments/assets/eb0f1aba-4c9a-4d9f-b7ff-8cdce2571fec" />
<img width="425" height="331" alt="image" src="https://github.com/user-attachments/assets/5cffe1ad-5b64-4a2e-aa19-102331bc6ffe" />
<img width="803" height="366" alt="image" src="https://github.com/user-attachments/assets/d35f81e2-e894-4703-bd16-0f992fa43a80" />
<img width="1872" height="632" alt="image" src="https://github.com/user-attachments/assets/f69e95d2-a4c3-49d1-9f8f-61a3b0064f2f" />
<img width="993" height="1288" alt="image" src="https://github.com/user-attachments/assets/da4578a1-67cb-4357-9545-391d41d62965" />
<img width="1016" height="1330" alt="image" src="https://github.com/user-attachments/assets/74b62b15-d5f1-4d1c-9c0a-f1bd9954a7da" />
<img width="1016" height="1330" alt="image" src="https://github.com/user-attachments/assets/011a1a69-967f-4760-8074-c1fdb86e7544" />
<img width="1111" height="240" alt="image" src="https://github.com/user-attachments/assets/e3f9fada-7542-482a-bc40-f1f031994d14" />
<img width="1062" height="1105" alt="image" src="https://github.com/user-attachments/assets/32ed9fe9-c211-4742-9f05-749edd4a5581" />
<img width="1008" height="1080" alt="image" src="https://github.com/user-attachments/assets/baef9e57-3283-425b-895c-812a161501f6" />
<img width="501" height="391" alt="image" src="https://github.com/user-attachments/assets/1caad57e-9e53-46d4-8743-fc684bf073e2" />
<img width="1132" height="1373" alt="image" src="https://github.com/user-attachments/assets/3a951e81-37dd-41ca-9947-cf84d0ac87a6" />
<img width="1100" height="1298" alt="image" src="https://github.com/user-attachments/assets/5bf56a5e-8be9-451e-96c3-e5793012fff8" />
<img width="1121" height="1371" alt="image" src="https://github.com/user-attachments/assets/b39f3fa8-30b9-4a2d-b77d-7c120faa93f6" />
<img width="1137" height="812" alt="image" src="https://github.com/user-attachments/assets/77ac6568-f6b0-47c0-bb6e-b69786a0aba3" />
<img width="1865" height="861" alt="image" src="https://github.com/user-attachments/assets/b4fadc5c-3f66-422c-8ee9-bd82de2406d1" />
<img width="1911" height="898" alt="image" src="https://github.com/user-attachments/assets/cbf61a32-e8cb-416c-8d77-ded1f52cac8b" />
<img width="441" height="428" alt="image" src="https://github.com/user-attachments/assets/5c619893-56de-4e3d-8c85-ddfec414627a" />
<img width="1865" height="872" alt="image" src="https://github.com/user-attachments/assets/8233e153-92b1-404e-885d-3eccb8e4469e" />
<img width="1902" height="852" alt="image" src="https://github.com/user-attachments/assets/6a95d53d-eb8a-4702-bcb8-76cd49d4896f" />
<img width="1908" height="695" alt="image" src="https://github.com/user-attachments/assets/4f965fea-5349-4db3-a078-000d01b909c6" />
<img width="1153" height="1206" alt="image" src="https://github.com/user-attachments/assets/656a7787-38f1-4e79-ab83-96a417bdbec5" />
<img width="931" height="470" alt="image" src="https://github.com/user-attachments/assets/359491c8-2bde-451b-8cd0-8eefc03fbda2" />
<img width="1093" height="967" alt="image" src="https://github.com/user-attachments/assets/1bf90fda-8b4b-4ae5-910d-148f1658395c" />
<img width="1776" height="852" alt="image" src="https://github.com/user-attachments/assets/918fb9f7-7911-4430-b1e8-aa3fb32a4c21" />
<img width="1830" height="840" alt="image" src="https://github.com/user-attachments/assets/2b4ab2fb-fad4-4f68-9db8-ac4d9a2803f6" />
<img width="2511" height="1131" alt="image" src="https://github.com/user-attachments/assets/befb66b5-b3a9-4f09-a8d0-1ced5c5c773c" />
<img width="1061" height="1232" alt="image" src="https://github.com/user-attachments/assets/ddb16cce-19df-4f8b-bcc8-bdd992240ce0" />
<img width="1112" height="857" alt="image" src="https://github.com/user-attachments/assets/2929082b-5072-44b7-8f06-af8b169e2092" />

```sh
curl -u admin:116c5ea72d32ef0c1fc0106a968738d606 -X POST http://localhost:8085/job/lab2-java-hello-world/buildWithParameters -d SLEEP_TIMER=20s
```

```txt
To generate the API token, go to admin->Security->API Token. Here, click on the Add new token button.

Enter rest-api-token in the Default name blank and click on Generate.
Immediately copy the token and store it securely. Scroll down in the Jenkins UI and click on Save.
Now, use this token to create your job using the curl command:
curl -u admin:116c5ea72d32ef0c1fc0106a968738d606 -X POST http://localhost:8085/job/lab2-java-hello-world/buildWithParameters -d SLEEP_TIMER=20s
Here, admin is your username and the token is placed after the colon :.

Go to your Jenkins UI and inspect the lab2-java-hello-world job. You should see a build running. Click on that build number and go to Parameters from the menu on the left sidebar.
You should see the value of SLEEP_TIMER as 20s, confirming that our curl command worked.
Now, copy the command that you ran to the file /root/solutions/task9.txt.

```

Next

11 / 11
Jenkins Pipeline and Basic Security

We have created a new user in Jenkins. Go ahead and check out the user details in the Jenkins UI.

The user credentials are as follows:

Username: zack
Password: password123
Using Jenkins CLI with Zack's credentials, run the below commands:

Dumps the job definition XML to stdout
java -jar jenkins-cli.jar -s http://<jenkins-url>/ -auth <zack-username:zack-password> get-job lab2-java-hello-world

Builds a job
java -jar jenkins-cli.jar -s http://<jenkins-url>/ -auth <zack-username:zack-password> build lab2-java-hello-world -f

Notice that both the above commands get executed successfully.

As a Jenkins Admin, you need to ensure that Zack can only access job definitions and restrict his ability to build jobs.

The Matrix Authorization Strategy plugin is already installed on Jenkins. Make changes within the Authorization settings to restrict Zackâ€™s ability to build jobs.

Re-run the Builds a job command:

java -jar jenkins-cli.jar -s http://<jenkins-url>/ -auth <zack-username:zack-password> build lab2-java-hello-world -f

This should then result in:

ERROR: zack is missing the Job/Build permission


Jenkins URL: http://localhost:8085/
Username: admin
Password: Adm!n321



Has Zack's ability been restricted to build jobs?



### Hint
Check out the newly created user in Jenkins UI.
Go to Manage Jenkins -> Users.


### Solution
```txt
Run the following command in the terminal:

java -jar jenkins-cli.jar -s http://localhost:8085/ -auth zack:password123 get-job lab2-java-hello-world
You should see the job definition XML as the output.

Also, run this command:

java -jar jenkins-cli.jar -s http://localhost:8085/ -auth zack:password123 build lab2-java-hello-world -f
Go to the job dashboard in the Jenkins UI and you should see a new build triggered.

We need to restrict this ability of building jobs for Zack.
To do this, follow the below steps:

Go to Manage Jenkins->Security.
Under Authorization, select Matrix-based security from the dropdown. You should see a grid now with various permissions.
Click on the Add user button at the bottom and enter zack in the User ID prompt that appears. Click on OK.
Select the following permissions (checkboxes) for Zack:
Read in the overall section.
Read in the Job section.
Click on the Save button at the bottom of the page.
Now, run the build job command provided above again. You should see an output like this:

ERROR: zack is missing the Job/Build permission
This confirms that we have restricted access for Zack.

```







